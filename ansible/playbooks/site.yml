---
- name: Baseline everywhere
  hosts: all
  gather_facts: true
  become: true
  roles:
    - role: baseline
      tags: [baseline]

- name: Public host web role
  hosts: public
  gather_facts: true
  become: true
  roles:
    - role: web
      tags: [web]

- name: Private host app role
  hosts: private
  gather_facts: true
  become: true
  roles:
    - role: app
      tags: [app]

- name: Post-deploy validation
  hosts: public
  gather_facts: false
  tags: [health, validate]
  tasks:
    - name: Validate backend reachability and health
      ansible.builtin.import_tasks: ../roles/web/tasks/healthcheck.yml